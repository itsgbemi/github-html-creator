<!DOCTYPE html>
<html>
<head>
<title>Blog Editor</title>
<link href="https://fonts.googleapis.com/css2?family=EB+Garamond:wght@400;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
:root {
  --purple: #f9f9f9;
  --purple-dark: #5e17eb;
  --gray-light: #f5f5f5;
  --gray-medium: #e1e4e8;
  --gray-dark: #586069;
  --text-dark: #24292e;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: 'Inter', sans-serif;
  max-width: 1000px;
  width: 100%;
  margin: 0 auto;
  display: flex;
  flex-direction: column;
  line-height: 1.6;
  color: var(--text-dark);
  letter-spacing: -0.01em;
  background-color: var(--purple);
  padding: 20px;
}

h1 { 
  font-family: 'EB Garamond', serif;
  font-weight: 700;
  color: var(--text-dark); 
  letter-spacing: -0.025em;
  margin: 0;
}

.top-bar {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 20px;
}

.tabs {
  display: flex;
  gap: 8px;
  margin-bottom: 20px;
}

.tab {
  padding: 8px 16px;
  cursor: pointer;
  border-radius: 20px;
  background: transparent;
  border: 1px solid transparent;
  font-weight: 500;
  letter-spacing: 0.01em;
  opacity: 0.7;
  transition: all 0.2s ease;
}

.tab.active {
  background: rgba(94, 23, 235, 0.1);
  border-color: var(--purple-dark);
  opacity: 1;
  color: var(--purple-dark);
  font-weight: 600;
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

.form-group { 
  margin-bottom: 20px;
}
.form-group .help-text {
  font-size: 0.85em;
  color: var(--gray-dark);
  margin-top: 4px;
  font-weight: 400;
}
label { 
  display: block; 
  font-weight: 500; 
  margin-bottom: 8px; 
  letter-spacing: 0.01em; 
}
input, textarea, select {
  width: 100%;
  padding: 12px 16px;
  border: 1px solid var(--gray-medium);
  border-radius: 20px;
  font-family: 'Inter', sans-serif;
  transition: all 0.2s ease;
  background: white;
}

input:focus, textarea:focus, select:focus {
  outline: none;
  border-color: var(--purple-dark);
  box-shadow: 0 0 0 2px rgba(94, 23, 235, 0.1);
}

textarea { min-height: 300px; }

button {
  background: var(--purple-dark);
  color: white;
  border: none;
  padding: 12px 24px;
  border-radius: 20px;
  cursor: pointer;
  font-weight: 500;
  letter-spacing: 0.01em;
  transition: all 0.2s ease;
}

button:hover {
  background: #4e17eb;
}

#result { margin-top: 20px; padding: 16px; border-radius: 8px; }
.success { background: #f0fff4; border: 1px solid #d1f3d8; }
.error { background: #ffebef; border: 1px solid #f5c6cb; }

.content-builder {
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.content-canvas {
  min-height: 400px;
  border: 1px solid var(--gray-medium);
  border-radius: 8px;
  padding: 20px;
  background: white;
}

.content-formatter {
  display: flex;
  flex-wrap: wrap;
  gap: 8px;
  padding: 12px;
  background: white;
  border: 1px solid var(--gray-medium);
  border-radius: 8px;
}

.format-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.format-button {
  background: transparent;
  border: none;
  padding: 8px;
  cursor: pointer;
  border-radius: 4px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.2s ease;
}

.format-button:hover {
  background: var(--gray-light);
}

.format-button.active {
  background: rgba(94, 23, 235, 0.1);
}

.format-button svg {
  width: 16px;
  height: 16px;
  fill: var(--gray-dark);
}

.format-button:hover svg {
  fill: var(--purple-dark);
}

.format-button.active svg {
  fill: var(--purple-dark);
}

select.format-select {
  width: auto;
  padding: 8px 12px;
  border-radius: 4px;
}

#editableContent {
  min-height: 400px;
  outline: none;
  padding: 10px;
}

#editableContent:focus {
  outline: none;
}

@media (max-width: 768px) {
  body {
    font-size: 14px;
    padding: 15px;
  }
  
  h1 {
    font-size: 1.5em;
  }
  
  .content-formatter {
    overflow-x: auto;
    padding: 8px;
    gap: 6px;
  }
  
  .format-group {
    gap: 6px;
  }
  
  .format-button {
    padding: 6px;
  }
  
  select.format-select {
    padding: 6px 8px;
    font-size: 0.9em;
  }
}

@media (max-width: 480px) {
  body {
    font-size: 13px;
  }
  
  .tab {
    padding: 6px 12px;
    font-size: 0.9em;
  }
  
  button {
    padding: 10px 18px;
  }
  
  input, textarea, select {
    padding: 10px 14px;
  }
  
  .content-formatter {
    gap: 4px;
  }
  
  .format-button svg {
    width: 14px;
    height: 14px;
  }
}
</style>
</head>
<body>
<div class="top-bar">
  <h1>Blog Editor</h1>
  <button type="submit" form="htmlForm">Create File</button>
</div>

<form id="htmlForm">
  <div class="tabs">
    <div class="tab active" data-tab="content">Content</div>
    <div class="tab" data-tab="seo">SEO</div>
    <div class="tab" data-tab="settings">Settings</div>
  </div>

  <div class="tab-content active" id="content-tab">
    <div class="content-builder">
      <div class="content-formatter">
        <div class="format-group">
          <select class="format-select" id="fontFamily">
            <option value="'Inter', sans-serif">Inter</option>
            <option value="'EB Garamond', serif">EB Garamond</option>
            <option value="Arial, sans-serif">Arial</option>
            <option value="Georgia, serif">Georgia</option>
            <option value="'Courier New', monospace">Courier New</option>
          </select>
        </div>
        
        <div class="format-group">
          <select class="format-select" id="fontSize">
            <option value="1em">Normal</option>
            <option value="0.8em">Small</option>
            <option value="1.2em">Large</option>
            <option value="1.5em">Extra Large</option>
          </select>
        </div>
        
        <div class="format-group">
          <select class="format-select" id="headingType">
            <option value="p">Paragraph</option>
            <option value="h1">Heading 1</option>
            <option value="h2">Heading 2</option>
            <option value="h3">Heading 3</option>
            <option value="h4">Heading 4</option>
          </select>
        </div>
        
        <div class="format-group">
          <button class="format-button" id="boldButton" title="Bold">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M15.6,11.79c0.97-0.67,1.65-1.77,1.65-2.79c0-2.26-1.75-4-4-4H7v14h7.04c2.09,0,3.71-1.7,3.71-3.79 C17.75,13.72,16.73,12.5,15.6,11.79z M10,7.5h3c0.83,0,1.5,0.67,1.5,1.5s-0.67,1.5-1.5,1.5h-3V7.5z M13.5,16.5h-3v-3h3 c0.83,0,1.5,0.67,1.5,1.5S14.33,16.5,13.5,16.5z"/>
            </svg>
          </button>
          <button class="format-button" id="italicButton" title="Italic">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M10,5v3h2.21l-3.42,8H6v3h8v-3h-2.21l3.42-8H18V5H10z"/>
            </svg>
          </button>
          <button class="format-button" id="underlineButton" title="Underline">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M12,17c3.31,0,6-2.69,6-6V3h-2.5v8c0,1.93-1.57,3.5-3.5,3.5S8.5,12.93,8.5,11V3H6v8C6,14.31,8.69,17,12,17z M5,19v2h14 v-2H5z"/>
            </svg>
          </button>
        </div>
        
        <div class="format-group">
          <button class="format-button" id="unorderedListButton" title="Bullet List">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M4,10.5c-0.83,0-1.5,0.67-1.5,1.5s0.67,1.5,1.5,1.5s1.5-0.67,1.5-1.5S4.83,10.5,4,10.5z M4,4.5c-0.83,0-1.5,0.67-1.5,1.5 S3.17,7.5,4,7.5S5.5,6.83,5.5,6S4.83,4.5,4,4.5z M4,16.5c-0.83,0-1.5,0.67-1.5,1.5s0.67,1.5,1.5,1.5s1.5-0.67,1.5-1.5 S4.83,16.5,4,16.5z M7,19h14v-2H7V19z M7,13h14v-2H7V13z M7,5v2h14V5H7z"/>
            </svg>
          </button>
          <button class="format-button" id="orderedListButton" title="Numbered List">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
              <path d="M2,17h2v0.5H3v1h1v0.5H2v1h3v-4H2V17z M5,10.5H2V11h3V10.5z M2,13h1.8L2,15.1V16h3v-1H3.2L5,12.9V12H2V13z M7,5v2h14V5H7z M7,19h14v-2H7V19z M7,13h14v-2H7V13z"/>
            </svg>
          </button>
        </div>
      </div>
      <div class="content-canvas">
        <div id="editableContent" contenteditable="true">
          <p>Start typing here...</p>
        </div>
      </div>
    </div>
    <textarea id="content" hidden required></textarea>
  </div>

  <div class="tab-content" id="seo-tab">
    <div class="form-group">
      <label for="title">Page Title:</label>
      <input type="text" id="title" placeholder="My Awesome Blog Post">
      <div class="help-text">The title that appears in browser tabs and search results (50-60 characters recommended)</div>
    </div>
    <div class="form-group">
      <label for="description">Meta Description:</label>
      <textarea id="description" placeholder="A brief description of the page content"></textarea>
      <div class="help-text">A summary of your content that appears in search results (150-160 characters recommended)</div>
    </div>
    <div class="form-group">
      <label for="keywords">Meta Keywords:</label>
      <input type="text" id="keywords" placeholder="blog, web design, development">
      <div class="help-text">Comma-separated keywords that describe your content (not as important for SEO as it used to be)</div>
    </div>
    <div class="form-group">
      <label for="author">Author:</label>
      <input type="text" id="author" placeholder="Your Name">
      <div class="help-text">The author of this content (helps with authorship attribution)</div>
    </div>
    <div class="form-group">
      <label for="viewport">Viewport:</label>
      <input type="text" id="viewport" value="width=device-width, initial-scale=1.0">
      <div class="help-text">Controls how your content displays on mobile devices (recommended to leave as default)</div>
    </div>
  </div>

  <div class="tab-content" id="settings-tab">
    <div class="form-group">
      <label for="repo">Repository (owner/repo):</label>
      <input type="text" id="repo" required placeholder="yourusername/reponame">
    </div>
    <div class="form-group">
      <label for="path">File path:</label>
      <input type="text" id="path" required placeholder="docs/index.html">
    </div>
  </div>
</form>

<div id="result"></div>

<script>
document.querySelectorAll('.tab').forEach(tab => {
  tab.addEventListener('click', () => {
    document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    tab.classList.add('active');
    document.getElementById(`${tab.dataset.tab}-tab`).classList.add('active');
  });
});

const editableContent = document.getElementById('editableContent');
const contentInput = document.getElementById('content');

// Formatting functions
function formatText(command, value = null) {
  document.execCommand(command, false, value);
  editableContent.focus();
}

// Event listeners for formatting buttons
document.getElementById('boldButton').addEventListener('click', () => formatText('bold'));
document.getElementById('italicButton').addEventListener('click', () => formatText('italic'));
document.getElementById('underlineButton').addEventListener('click', () => formatText('underline'));
document.getElementById('unorderedListButton').addEventListener('click', () => formatText('insertUnorderedList'));
document.getElementById('orderedListButton').addEventListener('click', () => formatText('insertOrderedList'));

// Font family change
document.getElementById('fontFamily').addEventListener('change', (e) => {
  formatText('fontName', e.target.value);
});

// Font size change
document.getElementById('fontSize').addEventListener('change', (e) => {
  formatText('fontSize', e.target.value === '1em' ? '3' : e.target.value === '0.8em' ? '2' : e.target.value === '1.2em' ? '4' : '5');
});

// Heading type change
document.getElementById('headingType').addEventListener('change', (e) => {
  formatText('formatBlock', `<${e.target.value}>`);
});

// Update hidden textarea with HTML content
function updateContentInput() {
  contentInput.value = editableContent.innerHTML;
}

editableContent.addEventListener('input', updateContentInput);

document.getElementById('htmlForm').addEventListener('submit', async (e) => {
  e.preventDefault();
  updateContentInput();

  const repo = document.getElementById('repo').value;
  const path = document.getElementById('path').value;
  const content = document.getElementById('content').value;
  const title = document.getElementById('title').value;
  const description = document.getElementById('description').value;
  const keywords = document.getElementById('keywords').value;
  const author = document.getElementById('author').value;
  const viewport = document.getElementById('viewport').value;

  const resultEl = document.getElementById('result');
  resultEl.innerHTML = '<svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,1A11,11,0,1,0,23,12,11,11,0,0,0,12,1Zm0,19a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z" opacity=".25"/><path d="M12,4a8,8,0,0,1,7.89,6.7A1.53,1.53,0,0,0,21.38,12h0a1.5,1.5,0,0,0,1.48-1.75,11,11,0,0,0-21.72,0A1.5,1.5,0,0,0,2.62,12h0a1.53,1.53,0,0,0,1.49-1.3A8,8,0,0,1,12,4Z"><animateTransform attributeName="transform" type="rotate" dur="0.75s" values="0 12 12;360 12 12" repeatCount="indefinite"/></path></svg> Creating file...';
  resultEl.className = '';

  try {
    const response = await fetch('/api/create-html', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ 
        repo, 
        path, 
        content,
        title,
        description,
        keywords,
        author,
        viewport
      })
    });

    const data = await response.json();

    if (response.ok) {
      resultEl.innerHTML = `
        <p><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><polygon points="10 14.59 7.71 12.29 6.29 13.71 10 17.41 17.71 9.71 16.29 8.29 10 14.59"/></svg> File created successfully!</p>
        <p><a href="${data.url}" target="_blank">View on GitHub</a></p>
        <details>
          <summary>Preview</summary>
          <iframe src="${data.downloadUrl}" style="width:100%; height:300px; border:1px solid #ddd; margin-top:10px;"></iframe>
        </details>
      `;
      resultEl.classList.add('success');
    } else {
      resultEl.innerHTML = `<p><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><rect x="11" y="6" width="2" height="9" rx="1"/><rect x="11" y="17" width="2" height="2" rx="1"/></svg> Error: ${data.error || 'Unknown error'}</p>`;
      resultEl.classList.add('error');
    }
  } catch (error) {
    resultEl.innerHTML = `<p><svg width="24" height="24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12,2A10,10,0,1,0,22,12,10,10,0,0,0,12,2Zm0,18a8,8,0,1,1,8-8A8,8,0,0,1,12,20Z"/><rect x="11" y="6" width="2" height="9" rx="1"/><rect x="11" y="17" width="2" height="2" rx="1"/></svg> Network error: ${error.message}</p>`;
    resultEl.classList.add('error');
  }
});
</script>
</body>
</html>
